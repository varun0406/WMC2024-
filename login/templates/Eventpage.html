{% extends './basenew.html' %}
{% block body %}
<!-- Google Web Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Saira:wght@500;600;700&family=Roboto:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">

<!-- Icon Font Stylesheet -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

<!-- Customized Bootstrap Stylesheet -->
<link href="/static/Eventpage/css/bootstrap.min.css" rel="stylesheet">

<!-- Template Stylesheet -->
<link href="/static/eventpage/css/style.css" rel="stylesheet">
<link href="/static/booking/css/style.css" rel="stylesheet">

<style>
    #nav-3 {
        border-bottom: 2px solid white;
    }
    body {
        background-color: black;
        color: white;
        font-family: 'Roboto', sans-serif;
    }
    .conta {
        margin: 0 6%;
    }
    .col {
        color: #26d48c;
    }
    .text-secondary {
        color: #26d48c;
    }
    .fa-angle-right:before {
        content: "\f105";
        margin-right: 6px;
    }
    .img-top {
        margin-top: 80px;
        width: 100%;
        background: url('https://images.pexels.com/photos/2747449/pexels-photo-2747449.jpeg?cs=srgb&dl=pexels-wolfgang-1002140-2747449.jpg&fm=jpg') no-repeat center center;
        background-size: cover;
        height: 400px;
    }
    .event-header {
        position: absolute;
        top: 180px;
        font-size: 38px;
        font-weight: 600;
        width: 100%;
        text-align: center;
        color: white;
    }
    .event-details {
        width: 80%;
        margin: 10% auto;
    }
    .event-images img {
        max-width: 100%;
        margin: 10px 0;
    }
    .booking-form {
        width: 450px;
        margin: 0 auto;
        background: #333;
        padding: 20px;
        border-radius: 10px;
    }
    .booking-form h3 {
        text-align: center;
        color: #ffcc00;
    }
    .input-group label {
        display: block;
        margin-bottom: 5px;
    }
    .input-group input {
        width: calc(100% - 10px);
        padding: 5px;
        margin-bottom: 10px;
    }
    .plus-minus-btn {
        display: flex;
        align-items: center;
    }
    .plus-minus-btn span {
        cursor: pointer;
        padding: 0 10px;
        background: #444;
        color: white;
    }
    .amount {
        display: flex;
        justify-content: space-between;
        margin: 10px 0;
    }
    .calculations hr {
        border-top: 1px solid #666;
    }
    .btn-style {
        background-color: #ffcc00;
        color: black;
        width: 100%;
        padding: 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    .btn-style:hover {
        background-color: #ffaa00;
    }
    .footer {
        background: black;
        color: white;
        padding: 20px 0;
    }
    .footer a {
        color: white;
    }
</style>

<div class="img-top"></div>
<div class="event-header">EVENTS</div>

<section class="main-content">
    <div class="event-details">
        <h2>{{ event.event_name }}</h2>
        <p>{{ event.event_desc }}</p>
        <p>Start Time: {{ event.event_s_time }}</p>
        <p>End Time: {{ event.event_e_time }}</p>
        
        <p>Organized by: {{ org.org_name }}</p>
        <div class="event-images">
            {% if event.Image1 %}
            <img src="{{ event.Image1.url }}" alt="Event Image 1">
            {% endif %}
            {% if event.Image2 %}
            <img src="{{ event.Image2.url }}" alt="Event Image 2">
            {% endif %}
            {% if event.Image3 %}
            <img src="{{ event.Image3.url }}" alt="Event Image 3">
            {% endif %}
            {% if event.Image4 %}
            <img src="{{ event.Image4.url }}" alt="Event Image 4">
            {% endif %}
        </div>
    </div>
</section>

<section class="main-content">
    <div class="booking-form" id="booking-and-confirmation">
        <form action="" method="post">
            {% csrf_token %}
            <div id="booking-input">
                <h3>Book Event Tickets</h3>
                <div class="input-group">
                    <label for="full-name">Full Name</label>
                    <input class="inp-style" id="full-name" name="full_name" type="text" placeholder="Full name" required>
                </div>
                <div class="input-group">
                    <label for="email">Email</label>
                    <input class="inp-style" id="email" name="email" type="email" placeholder="Email" required>
                </div>
                <label for="ticket-number">Tickets (${{ event.Event_Tickets }})</label>
                <div class="input-group">
                    <div class="plus-minus-btn">
                        <span id="ticket-minus" class="control">-</span>
                    </div>
                    <div>
                        <input class="inp-style inp-width" type="text" id="ticket-number" name="ticket_number" value="0">
                    </div>
                    <div class="plus-minus-btn">
                        <span id="ticket-plus" class="control">+</span>
                    </div>
                </div>
                <div class="calculations">
                    <div class="amount">
                        <div class="left">
                            <p>Subtotal</p>
                        </div>
                        <div class="right">
                            <p>$<span id="price-subtotal">0</span></p>
                        </div>
                    </div>
                    <div class="amount">
                        <div class="left">
                            <p>Membership Discount ({{ discount }}%)</p>
                        </div>
                        <div class="right">
                            <p>- $<span id="membership">0</span></p>
                        </div>
                    </div>
                    <hr>
                    <div class="amount">
                        <div class="left">
                            <h4>Total</h4>
                        </div>
                        <div class="right">
                            <p>$<span id="price-total">0</span></p>
                        </div>
                    </div>
                </div>
                <button class="btn-style" id="book-now-button" type="submit">Pay Now</button>
            </div>
        </form>
    </div>
</section>

<section style="width: 100%; box-sizing: border-box;">
    <div>
        <div style="display: flex; justify-content: center; align-items: center; color: white; background-color: black;">
            <div style="width: 50%; text-align: center;">
                <div class="section-title">
                    <h2 style="color: yellow; font-size: 30px;">Location</h2>
                    <p style="font-size: 20px;">Get directions to our event center</p>
                </div>
                <div class="cs-text">
                    <div class="ct-address">
                        <span style="color: yellow; font-size: 28px;">Address:</span>
                        <p style="font-size: 20px;"><iframe src="{{ venue.venue_address }}" width='600' height='450' style='border:0;' allowfullscreen='' loading='lazy' referrerpolicy='no-referrer-when-downgrade'></iframe></p>
                    </div>
                    <ul style="list-style-type: none;">
                        <li>
                            <span style="color: yellow; font-size: 24px;">Phone:</span>
                            <p style="font-size: 20px;">{{ venue.venue_phone }}</p>
                        </li>
                        <li>
                            <span style="color: yellow; font-size: 24px;">Email:</span>
                            <p style="font-size: 20px;">{{ venue.venue_email }}</p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div style="width: 50%;">
            <iframe src="{{ venue.venue_location }}" width="600" height="450" style="border: 0;" allowfullscreen loading="lazy"></iframe>
        </div>
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const ticketNumber = document.getElementById('ticket-number');
        const priceSubtotal = document.getElementById('price-subtotal');
        const membership = document.getElementById('membership');
        const priceTotal = document.getElementById('price-total');
        const ticketPrice = {{ event.Event_Tickets }};
        const discountPercent = {{ discount }};

        document.getElementById('ticket-plus').addEventListener('click', function() {
            ticketNumber.value = parseInt(ticketNumber.value) + 1;
            updatePrice();
        });

        document.getElementById('ticket-minus').addEventListener('click', function() {
            if (ticketNumber.value > 0) {
                ticketNumber.value = parseInt(ticketNumber.value) - 1;
                updatePrice();
            }
        });

        function updatePrice() {
            const subtotal = ticketNumber.value * ticketPrice;
            priceSubtotal.innerText = subtotal.toFixed(2);
            const discountAmount = subtotal * (discountPercent / 100);
            membership.innerText = discountAmount.toFixed(2);
            const total = subtotal - discountAmount;
            priceTotal.innerText = total.toFixed(2);
        }
    });
</script>

{% endblock %}
